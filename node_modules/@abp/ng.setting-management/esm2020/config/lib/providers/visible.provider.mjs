import { APP_INITIALIZER, Injector } from '@angular/core';
import { combineLatest } from 'rxjs';
import { RoutesService } from '@abp/ng.core';
import { SETTING_MANAGEMENT_HAS_SETTING } from './route.provider';
import { SETTING_MANAGEMENT_ROUTE_VISIBILITY } from './features.token';
export const SETTING_MANAGEMENT_VISIBLE_PROVIDERS = [
    {
        provide: APP_INITIALIZER,
        useFactory: setSettingManagementVisibility,
        deps: [Injector],
        multi: true,
    },
];
export function setSettingManagementVisibility(injector) {
    return () => {
        const settingManagementHasSetting$ = injector.get(SETTING_MANAGEMENT_HAS_SETTING);
        const isSettingManagementFeatureEnable$ = injector.get(SETTING_MANAGEMENT_ROUTE_VISIBILITY);
        const routes = injector.get(RoutesService);
        combineLatest([settingManagementHasSetting$, isSettingManagementFeatureEnable$]).subscribe(([settingManagementHasSetting, isSettingManagementFeatureEnable]) => {
            routes.patch("AbpSettingManagement::Settings" /* eSettingManagementRouteNames.Settings */, {
                invisible: !(settingManagementHasSetting && isSettingManagementFeatureEnable),
            });
        });
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlzaWJsZS5wcm92aWRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL3NldHRpbmctbWFuYWdlbWVudC9jb25maWcvc3JjL2xpYi9wcm92aWRlcnMvdmlzaWJsZS5wcm92aWRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsZUFBZSxFQUFFLFFBQVEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMxRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3JDLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFDN0MsT0FBTyxFQUFFLDhCQUE4QixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbEUsT0FBTyxFQUFFLG1DQUFtQyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFHdkUsTUFBTSxDQUFDLE1BQU0sb0NBQW9DLEdBQUc7SUFDbEQ7UUFDRSxPQUFPLEVBQUUsZUFBZTtRQUN4QixVQUFVLEVBQUUsOEJBQThCO1FBQzFDLElBQUksRUFBRSxDQUFDLFFBQVEsQ0FBQztRQUNoQixLQUFLLEVBQUUsSUFBSTtLQUNaO0NBQ0YsQ0FBQztBQUVGLE1BQU0sVUFBVSw4QkFBOEIsQ0FBQyxRQUFrQjtJQUMvRCxPQUFPLEdBQUcsRUFBRTtRQUNWLE1BQU0sNEJBQTRCLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO1FBQ2xGLE1BQU0saUNBQWlDLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFDO1FBQzVGLE1BQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDM0MsYUFBYSxDQUFDLENBQUMsNEJBQTRCLEVBQUUsaUNBQWlDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FDeEYsQ0FBQyxDQUFDLDJCQUEyQixFQUFFLGdDQUFnQyxDQUFDLEVBQUUsRUFBRTtZQUNsRSxNQUFNLENBQUMsS0FBSywrRUFBd0M7Z0JBQ2xELFNBQVMsRUFBRSxDQUFDLENBQUMsMkJBQTJCLElBQUksZ0NBQWdDLENBQUM7YUFDOUUsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUNGLENBQUM7SUFDSixDQUFDLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQVBQX0lOSVRJQUxJWkVSLCBJbmplY3RvciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBjb21iaW5lTGF0ZXN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IFJvdXRlc1NlcnZpY2UgfSBmcm9tICdAYWJwL25nLmNvcmUnO1xyXG5pbXBvcnQgeyBTRVRUSU5HX01BTkFHRU1FTlRfSEFTX1NFVFRJTkcgfSBmcm9tICcuL3JvdXRlLnByb3ZpZGVyJztcclxuaW1wb3J0IHsgU0VUVElOR19NQU5BR0VNRU5UX1JPVVRFX1ZJU0lCSUxJVFkgfSBmcm9tICcuL2ZlYXR1cmVzLnRva2VuJztcclxuaW1wb3J0IHsgZVNldHRpbmdNYW5hZ2VtZW50Um91dGVOYW1lcyB9IGZyb20gJy4uL2VudW1zJztcclxuXHJcbmV4cG9ydCBjb25zdCBTRVRUSU5HX01BTkFHRU1FTlRfVklTSUJMRV9QUk9WSURFUlMgPSBbXHJcbiAge1xyXG4gICAgcHJvdmlkZTogQVBQX0lOSVRJQUxJWkVSLFxyXG4gICAgdXNlRmFjdG9yeTogc2V0U2V0dGluZ01hbmFnZW1lbnRWaXNpYmlsaXR5LFxyXG4gICAgZGVwczogW0luamVjdG9yXSxcclxuICAgIG11bHRpOiB0cnVlLFxyXG4gIH0sXHJcbl07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0U2V0dGluZ01hbmFnZW1lbnRWaXNpYmlsaXR5KGluamVjdG9yOiBJbmplY3Rvcikge1xyXG4gIHJldHVybiAoKSA9PiB7XHJcbiAgICBjb25zdCBzZXR0aW5nTWFuYWdlbWVudEhhc1NldHRpbmckID0gaW5qZWN0b3IuZ2V0KFNFVFRJTkdfTUFOQUdFTUVOVF9IQVNfU0VUVElORyk7XHJcbiAgICBjb25zdCBpc1NldHRpbmdNYW5hZ2VtZW50RmVhdHVyZUVuYWJsZSQgPSBpbmplY3Rvci5nZXQoU0VUVElOR19NQU5BR0VNRU5UX1JPVVRFX1ZJU0lCSUxJVFkpO1xyXG4gICAgY29uc3Qgcm91dGVzID0gaW5qZWN0b3IuZ2V0KFJvdXRlc1NlcnZpY2UpO1xyXG4gICAgY29tYmluZUxhdGVzdChbc2V0dGluZ01hbmFnZW1lbnRIYXNTZXR0aW5nJCwgaXNTZXR0aW5nTWFuYWdlbWVudEZlYXR1cmVFbmFibGUkXSkuc3Vic2NyaWJlKFxyXG4gICAgICAoW3NldHRpbmdNYW5hZ2VtZW50SGFzU2V0dGluZywgaXNTZXR0aW5nTWFuYWdlbWVudEZlYXR1cmVFbmFibGVdKSA9PiB7XHJcbiAgICAgICAgcm91dGVzLnBhdGNoKGVTZXR0aW5nTWFuYWdlbWVudFJvdXRlTmFtZXMuU2V0dGluZ3MsIHtcclxuICAgICAgICAgIGludmlzaWJsZTogIShzZXR0aW5nTWFuYWdlbWVudEhhc1NldHRpbmcgJiYgaXNTZXR0aW5nTWFuYWdlbWVudEZlYXR1cmVFbmFibGUpLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LFxyXG4gICAgKTtcclxuICB9O1xyXG59XHJcbiJdfQ==